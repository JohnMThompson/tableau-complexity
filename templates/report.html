<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tableau Workbook Complexity Report</title>
  <link rel="stylesheet" href="report_assets/style.css">
</head>
<body>
  <header class="tc-header">
    <div>
      <p class="eyebrow">Tableau Workbook Complexity</p>
      <h1 id="report-title">Workbook Report</h1>
      <p class="subtitle">Insights generated from tableau_complexity.py</p>
    </div>
    <div class="meta">
      <div>Generated</div>
      <div id="generated-at" class="meta-value">--</div>
    </div>
  </header>

  <main>
    <section>
      <h2>Summary</h2>
      <div id="summary-grid" class="card-grid"></div>
    </section>

    <section id="directory-section" class="hidden">
      <h2>Directory Summary</h2>
      <p class="section-desc">Aggregated stats across all analyzed workbooks.</p>
      <div id="directory-summary" class="card-grid"></div>
      <div id="mark-chart" class="chart-card"></div>
      <div class="table-wrapper">
        <table id="workbook-table">
          <thead>
            <tr>
              <th>Workbook</th>
              <th>Overall Score</th>
              <th>Worksheets</th>
              <th>Max Score</th>
              <th>Min Score</th>
              <th>Calc Fields</th>
              <th>Formula Complexity</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section id="filter-section" class="hidden">
      <label for="workbook-filter">Filter worksheets by workbook</label>
      <select id="workbook-filter"></select>
    </section>

    <section>
      <h2>Worksheets</h2>
      <p class="section-desc">Per-worksheet metrics with calculated fields and complexity scores.</p>
      <div class="table-wrapper">
        <table id="worksheet-table">
          <thead>
            <tr>
              <th>Worksheet</th>
              <th>Complexity</th>
              <th>Mark Types</th>
              <th>Shelf Density</th>
              <th>Calc Fields</th>
              <th>Key Metrics</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section id="calc-section">
      <h2>Calculated Fields</h2>
      <p class="section-desc">Formulas grouped by worksheet with heuristic complexity scores.</p>
      <div id="calc-accordion" class="accordion"></div>
    </section>

  </main>

  <footer>
    <p>Generated by <code>tableau_complexity.py</code>. Review and adapt for your environment.</p>
  </footer>

  <script type="application/json" id="report-data">
  {{DATA_JSON}}
  </script>
  <script src="report_assets/report.js"></script>
</body>
</html>
